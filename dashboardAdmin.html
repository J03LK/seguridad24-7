<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrador | 24/7 Seguridad</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css">
    <link rel="stylesheet" href="estilos/Admin.css">
</head>
<body>
    <!-- Botón Menu para responsive -->
    <button class="menu-toggle" id="menu-toggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-shield-alt"></i><span>24/7</span> Seguridad
            </div>
        </div>
        <ul class="nav-links">
            <li><a href="#dashboard" class="active" data-section="dashboard-section"><i class="fas fa-home"></i> Dashboard</a></li>
            <li><a href="#usuarios" data-section="usuarios-section"><i class="fas fa-users"></i> Usuarios</a></li>
            <li><a href="#productos" data-section="productos-section"><i class="fas fa-video"></i> Productos</a></li>
            <li><a href="#ubicaciones" data-section="ubicaciones-section"><i class="fas fa-map-marker-alt"></i> Ubicaciones</a></li>
            <li><a href="#pagos" data-section="pagos-section"><i class="fas fa-money-bill-wave"></i> Pagos</a></li>
            <li><a href="#reportes" data-section="reportes-section"><i class="fas fa-chart-bar"></i> Reportes</a></li>
            <li><a href="#configuracion" data-section="configuracion-section"><i class="fas fa-cog"></i> Configuración</a></li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="top-bar">
            <div class="search-container">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Buscar...">
            </div>
            
            <div class="user-info">
                <div class="notification">
                    <i class="fas fa-bell"></i>
                    <span class="badge">3</span>
                </div>
                <div class="user-profile">
                    <div class="avatar">A</div>
                    <div class="info">
                        <span class="name">Admin</span>
                        <span class="role">Administrador</span>
                    </div>
                    <button id="logout-btn" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Dashboard Section -->
        <section id="dashboard-section">
            <h1 class="page-title">Dashboard</h1>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="title">Clientes Activos</div>
                    <div class="value" id="clientes-activos">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 12%</div>
                    <div class="icon"><i class="fas fa-users"></i></div>
                </div>
                <div class="stat-card accent">
                    <div class="title">Servicios Instalados</div>
                    <div class="value" id="servicios-instalados">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 8%</div>
                    <div class="icon"><i class="fas fa-video"></i></div>
                </div>
                <div class="stat-card">
                    <div class="title">Alertas</div>
                    <div class="value" id="alertas-actuales">0</div>
                    <div class="change negative"><i class="fas fa-arrow-up"></i> 5%</div>
                    <div class="icon"><i class="fas fa-exclamation-triangle"></i></div>
                </div>
                <div class="stat-card accent">
                    <div class="title">Ingresos Mensuales</div>
                    <div class="value" id="ingresos-mensuales">$0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 15%</div>
                    <div class="icon"><i class="fas fa-money-bill-wave"></i></div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="chart-section">
                    <div class="section-title">
                        <span>Rendimiento del Sistema</span>
                        <div class="time-filter">
                            <button class="active" data-period="daily">Día</button>
                            <button data-period="weekly">Semana</button>
                            <button data-period="monthly">Mes</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="performance-chart"></canvas>
                    </div>
                </div>
                <div class="recent-activities">
                    <div class="section-title">Actividades Recientes</div>
                    <ul class="activity-list" id="activity-list">
                        <!-- Se llenará con JavaScript -->
                    </ul>
                </div>
            </div>

            <div class="map-section">
                <div class="section-title">
                    <span>Mapa de Clientes</span>
                    <div class="map-controls">
                        <div class="filter-group">
                            <button class="filter-btn active" data-filter="all">Todos</button>
                            <button class="filter-btn" data-filter="active">Activos</button>
                            <button class="filter-btn" data-filter="alert">Alertas</button>
                        </div>
                        <button class="add-location" id="add-location-btn">
                            <i class="fas fa-plus"></i> Nueva Ubicación
                        </button>
                    </div>
                </div>
                <div id="map"></div>
            </div>
        </section>

        <!-- Usuarios Section -->
        <section id="usuarios-section" class="section-hide">
            <h1 class="page-title">Gestión de Usuarios</h1>
            
            <div class="table-container">
                <div class="table-header">
                    <div class="section-title">Lista de Usuarios</div>
                    <button class="action-btn" id="add-user-btn">
                        <i class="fas fa-plus"></i> Nuevo Usuario
                    </button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Email</th>
                            <th>Teléfono</th>
                            <th>Dirección</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="users-table">
                        <!-- Se llenará con JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Productos Section -->
        <section id="productos-section" class="section-hide">
            <h1 class="page-title">Gestión de Productos</h1>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="title">Cámaras</div>
                    <div class="value" id="camaras-stock">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 5%</div>
                    <div class="icon"><i class="fas fa-video"></i></div>
                </div>
                <div class="stat-card accent">
                    <div class="title">Cercos Eléctricos</div>
                    <div class="value" id="cercos-stock">0</div>
                    <div class="change negative"><i class="fas fa-arrow-down"></i> 2%</div>
                    <div class="icon"><i class="fas fa-bolt"></i></div>
                </div>
                <div class="stat-card">
                    <div class="title">Baterías</div>
                    <div class="value" id="baterias-stock">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 10%</div>
                    <div class="icon"><i class="fas fa-battery-full"></i></div>
                </div>
                <div class="stat-card accent">
                    <div class="title">Otros</div>
                    <div class="value" id="otros-stock">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 3%</div>
                    <div class="icon"><i class="fas fa-boxes"></i></div>
                </div>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <div class="section-title">Inventario de Productos</div>
                    <button class="action-btn" id="add-product-btn">
                        <i class="fas fa-plus"></i> Nuevo Producto
                    </button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Producto</th>
                            <th>Categoría</th>
                            <th>Stock</th>
                            <th>Precio</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="products-table">
                        <!-- Se llenará con JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Ubicaciones Section -->
        <section id="ubicaciones-section" class="section-hide">
            <h1 class="page-title">Gestión de Ubicaciones</h1>
            
            <div class="map-section">
                <div class="section-title">
                    <span>Mapa de Clientes</span>
                    <button class="add-location" id="add-location-btn-2">
                        <i class="fas fa-plus"></i> Nueva Ubicación</button>
                </div>
                <div id="map-location" class="map"></div>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <div class="section-title">Lista de Ubicaciones</div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Cliente</th>
                            <th>Dirección</th>
                            <th>Tipo</th>
                            <th>Estado</th>
                            <th>Última Verificación</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="locations-table">
                        <!-- Se llenará con JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Pagos Section -->
        <section id="pagos-section" class="section-hide">
            <h1 class="page-title">Gestión de Pagos</h1>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="title">Ingresos del Mes</div>
                    <div class="value" id="ingresos-mes">$0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 8%</div>
                    <div class="icon"><i class="fas fa-dollar-sign"></i></div>
                </div>
                <div class="stat-card accent">
                    <div class="title">Pagos Pendientes</div>
                    <div class="value" id="pagos-pendientes">0</div>
                    <div class="change negative"><i class="fas fa-arrow-up"></i> 3%</div>
                    <div class="icon"><i class="fas fa-clock"></i></div>
                </div>
                <div class="stat-card">
                    <div class="title">Facturas Emitidas</div>
                    <div class="value" id="facturas-mes">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 5%</div>
                    <div class="icon"><i class="fas fa-file-invoice"></i></div>
                </div>
                <div class="stat-card accent">
                    <div class="title">Servicios Activos</div>
                    <div class="value" id="servicios-activos">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 2%</div>
                    <div class="icon"><i class="fas fa-shield-alt"></i></div>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="chart-section">
                    <div class="section-title">
                        <span>Ingresos vs Gastos</span>
                        <div class="time-filter">
                            <button class="active" data-period="monthly">Mensual</button>
                            <button data-period="quarterly">Trimestral</button>
                            <button data-period="yearly">Anual</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="finance-chart"></canvas>
                    </div>
                </div>
                <div class="chart-section">
                    <div class="section-title">
                        <span>Distribución de Servicios</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="services-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <div class="section-title">Historial de Pagos</div>
                    <button class="action-btn" id="add-payment-btn">
                        <i class="fas fa-plus"></i> Registrar Pago
                    </button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Factura</th>
                            <th>Cliente</th>
                            <th>Monto</th>
                            <th>Fecha</th>
                            <th>Método</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="payments-table">
                        <!-- Se llenará con JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Reportes Section -->
        <section id="reportes-section" class="section-hide">
            <h1 class="page-title">Reportes</h1>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="title">Instalaciones</div>
                    <div class="value" id="total-instalaciones">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 15%</div>
                    <div class="icon"><i class="fas fa-tools"></i></div>
                </div>
                <div class="stat-card accent">
                    <div class="title">Alertas Atendidas</div>
                    <div class="value" id="alertas-atendidas">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 7%</div>
                    <div class="icon"><i class="fas fa-bell"></i></div>
                </div>
                <div class="stat-card">
                    <div class="title">Mantenimientos</div>
                    <div class="value" id="total-mantenimientos">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 10%</div>
                    <div class="icon"><i class="fas fa-wrench"></i></div>
                </div>
                <div class="stat-card accent">
                    <div class="title">Clientes Nuevos</div>
                    <div class="value" id="nuevos-clientes">0</div>
                    <div class="change positive"><i class="fas fa-arrow-up"></i> 12%</div>
                    <div class="icon"><i class="fas fa-user-plus"></i></div>
                </div>
            </div>
            
            <div class="dashboard-grid">
                <div class="chart-section">
                    <div class="section-title">
                        <span>Desempeño Anual</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="annual-chart"></canvas>
                    </div>
                </div>
                <div class="recent-activities">
                    <div class="section-title">Reportes Disponibles</div>
                    <ul class="activity-list">
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">Ventas Mensuales</div>
                                <div class="activity-time">Actualizado: Hace 2 días</div>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-file-excel"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">Rendimiento por Zona</div>
                                <div class="activity-time">Actualizado: Hoy</div>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">Inventario Detallado</div>
                                <div class="activity-time">Actualizado: Hace 1 semana</div>
                            </div>
                        </li>
                        <li class="activity-item">
                            <div class="activity-icon warning">
                                <i class="fas fa-file-excel"></i>
                            </div>
                            <div class="activity-content">
                                <div class="activity-title">Alertas por Cliente</div>
                                <div class="activity-time">Actualizado: Hace 3 días</div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="table-container">
                <div class="table-header">
                    <div class="section-title">Alertas Recientes</div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Cliente</th>
                            <th>Ubicación</th>
                            <th>Tipo</th>
                            <th>Fecha</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="alerts-table">
                        <!-- Se llenará con JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Configuración Section -->
        <section id="configuracion-section" class="section-hide">
            <h1 class="page-title">Configuración</h1>
            
            <div class="table-container">
                <div class="section-title">Preferencias del Sistema</div>
                
                <div class="form-group">
                    <label for="tema">Tema</label>
                    <select id="tema" class="form-control">
                        <option value="dark">Oscuro</option>
                        <option value="light">Claro</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="idioma">Idioma</label>
                    <select id="idioma" class="form-control">
                        <option value="es">Español</option>
                        <option value="en">Inglés</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="notificaciones">Notificaciones</label>
                    <div>
                        <input type="checkbox" id="not-email" checked>
                        <label for="not-email" style="display: inline; margin-left: 5px;">Email</label>
                    </div>
                    <div style="margin-top: 10px;">
                        <input type="checkbox" id="not-app" checked>
                        <label for="not-app" style="display: inline; margin-left: 5px;">Aplicación</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="tiempo-sesion">Tiempo de Sesión (minutos)</label>
                    <input type="number" id="tiempo-sesion" class="form-control" value="30" min="5" max="120">
                </div>
                
                <button class="btn btn-primary" style="margin-top: 20px;">
                    Guardar Configuración
                </button>
            </div>
            
            <div class="table-container">
                <div class="section-title">Perfil de Usuario</div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="user-name-profile">Nombre</label>
                        <input type="text" id="user-name-profile" class="form-control" value="Administrador">
                    </div>
                    <div class="form-group">
                        <label for="user-email-profile">Email</label>
                        <input type="email" id="user-email-profile" class="form-control" value="admin@seguridad247.com">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="current-password">Contraseña Actual</label>
                    <input type="password" id="current-password" class="form-control">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="new-password">Nueva Contraseña</label>
                        <input type="password" id="new-password" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Confirmar Contraseña</label>
                        <input type="password" id="confirm-password" class="form-control">
                    </div>
                </div>
                
                <button class="btn btn-primary" style="margin-top: 20px;">
                    Actualizar Perfil
                </button>
            </div>
        </section>
    </main>

    <!-- Modales -->
    <!-- Modal para Añadir Usuario -->
    <!-- Modal para Añadir Usuario -->
<div id="add-user-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">Añadir Nuevo Usuario</h2>
            <span class="close">&times;</span>
        </div>
        <form id="add-user-form">
            <div class="form-row">
                <div class="form-group">
                    <label for="user-name">Nombre Completo</label>
                    <input type="text" id="user-name" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="user-email">Email</label>
                    <input type="email" id="user-email" class="form-control" required>
                </div>
            </div>
            <!-- Nuevo campo para contraseña -->
            <div class="form-row">
                <div class="form-group">
                    <label for="user-password">Contraseña</label>
                    <input type="password" id="user-password" class="form-control" required>
                </div>
                <!-- Nuevo campo para seleccionar rol -->
                <div class="form-group">
                    <label for="user-role">Rol</label>
                    <select id="user-role" class="form-control" required>
                        <option value="">Seleccionar</option>
                        <option value="admin">Administrador</option>
                        <option value="usuario">Usuario</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="user-phone">Teléfono</label>
                    <input type="tel" id="user-phone" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="user-type">Tipo</label>
                    <select id="user-type" class="form-control" required>
                        <option value="">Seleccionar</option>
                        <option value="residential">Residencial</option>
                        <option value="commercial">Comercial</option>
                        <option value="industrial">Industrial</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="user-address">Dirección</label>
                <input type="text" id="user-address" class="form-control" required>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                <button type="submit" class="btn btn-primary">Guardar</button>
            </div>
        </form>
    </div>
</div>

    <!-- Modal para Añadir Producto -->
    <div id="add-product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Añadir Nuevo Producto</h2>
                <span class="close">&times;</span>
            </div>
            <form id="add-product-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="product-name">Nombre del Producto</label>
                        <input type="text" id="product-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="product-category">Categoría</label>
                        <select id="product-category" class="form-control" required>
                            <option value="">Seleccionar</option>
                            <option value="camera">Cámara</option>
                            <option value="fence">Cerco Eléctrico</option>
                            <option value="battery">Batería</option>
                            <option value="other">Otro</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="product-price">Precio</label>
                        <input type="number" id="product-price" class="form-control" required min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="product-stock">Stock</label>
                        <input type="number" id="product-stock" class="form-control" required min="0">
                    </div>
                </div>
                <div class="form-group">
                    <label for="product-description">Descripción</label>
                    <textarea id="product-description" class="form-control" rows="3"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Añadir Ubicación -->
    <div id="add-location-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Añadir Nueva Ubicación</h2>
                <span class="close">&times;</span>
            </div>
            <form id="add-location-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="location-client">Cliente</label>
                        <select id="location-client" class="form-control" required>
                            <option value="">Seleccionar Cliente</option>
                            <!-- Se llenará dinámicamente -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="location-type">Tipo</label>
                        <select id="location-type" class="form-control" required>
                            <option value="">Seleccionar</option>
                            <option value="residential">Residencial</option>
                            <option value="commercial">Comercial</option>
                            <option value="industrial">Industrial</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="location-address">Dirección</label>
                    <input type="text" id="location-address" class="form-control" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="location-lat">Latitud</label>
                        <input type="text" id="location-lat" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="location-lng">Longitud</label>
                        <input type="text" id="location-lng" class="form-control" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="location-description">Notas</label>
                    <textarea id="location-description" class="form-control" rows="2"></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>
<!-- Modal para Registrar Pago -->
<div id="add-payment-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">Registrar Pago</h2>
            <span class="close">&times;</span>
        </div>
        <form id="add-payment-form">
            <div class="form-row">
                <div class="form-group">
                    <label for="payment-client">Cliente</label>
                    <select id="payment-client" class="form-control" required>
                        <option value="">Seleccionar Cliente</option>
                        <!-- Se llenará dinámicamente -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="payment-amount">Monto</label>
                    <input type="number" id="payment-amount" class="form-control" required min="0" step="0.01">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="payment-date">Fecha</label>
                    <input type="date" id="payment-date" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="payment-method">Método</label>
                    <select id="payment-method" class="form-control" required>
                        <option value="">Seleccionar</option>
                        <option value="cash">Efectivo</option>
                        <option value="card">Tarjeta</option>
                        <option value="transfer">Transferencia</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="payment-description">Descripción</label>
                <textarea id="payment-description" class="form-control" rows="2"></textarea>
            </div>
            <div class="form-group">
                <label for="generate-invoice">Generar Factura</label>
                <div>
                    <input type="checkbox" id="generate-invoice" checked>
                    <label for="generate-invoice" style="display: inline; margin-left: 5px;">Sí, generar factura</label>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary modal-close">Cancelar</button>
                <button type="submit" class="btn btn-primary">Registrar</button>
            </div>
        </form>
    </div>
</div>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<!-- Script para inicializar Firebase y manejar usuarios -->
<script>
  // Inicializar Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyD_C3sJCghWpV1DHn4Qyxsa-exdcEJGst0",
    authDomain: "seguridad-24-7.firebaseapp.com",
    projectId: "seguridad-24-7",
    storageBucket: "seguridad-24-7.firebasestorage.app",
    messagingSenderId: "979899411271",
    appId: "1:979899411271:web:4d8db498a9388054a7fa62",
    measurementId: "G-XQG0KDMMX4"
  };

  // Inicializar Firebase
  firebase.initializeApp(firebaseConfig);

  // Referencias
  const auth = firebase.auth();
  const db = firebase.firestore();

  // Manejar formulario de usuario
  const userForm = document.getElementById('add-user-form');
  if (userForm) {
    userForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Obtener datos
      const email = document.getElementById('user-email').value;
      const password = document.getElementById('user-password').value;
      const name = document.getElementById('user-name').value;
      const role = document.getElementById('user-role').value;
      const phone = document.getElementById('user-phone').value;
      const address = document.getElementById('user-address').value;
      const type = document.getElementById('user-type').value;
      
      // Validación básica
      if (!email || !password || !name || !role) {
        showNotification("Por favor complete todos los campos obligatorios", "warning");
        return;
      }
      
      // Crear usuario
      auth.createUserWithEmailAndPassword(email, password)
        .then(function(userCredential) {
          // Guardar datos adicionales
          return db.collection("users").doc(userCredential.user.uid).set({
            email: email,
            name: name,
            role: role,
            phone: phone || "",
            address: address || "",
            type: type || "",
            status: "active",
            createdAt: new Date()
          });
        })
        .then(function() {
          // Éxito
          const modal = userForm.closest('.modal');
          if (modal) modal.style.display = 'none';
          userForm.reset();
          showNotification(`Usuario ${name} creado exitosamente como ${role}`, "success");
        })
        .catch(function(error) {
          // Error
          console.error("Error:", error);
          showNotification("Error: " + error.message, "error");
        });
    });
  }
</script>
<script>
    // Verificar autenticación y rol de usuario
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof firebase !== 'undefined') {
            // Verificar el estado de autenticación
            firebase.auth().onAuthStateChanged(function(user) {
                if (user) {
                    // Verificar si el usuario es admin
                    firebase.firestore().collection('users').doc(user.uid).get()
                        .then(function(doc) {
                            if (doc.exists) {
                                const userData = doc.data();
                                
                                if (userData.role !== 'admin') {
                                    // No es admin, redirigir a página de usuario
                                    window.location.href = "usuario.html";
                                } else {
                                    // Actualizar información del admin en la UI
                                    const userNameElement = document.querySelector('.user-profile .name');
                                    if (userNameElement) {
                                        userNameElement.textContent = userData.name || 'Admin';
                                    }
                                }
                            } else {
                                // No hay datos de usuario, redirigir al login
                                window.location.href = "login.html";
                            }
                        })
                        .catch(function(error) {
                            console.error("Error al verificar rol:", error);
                            window.location.href = "login.html";
                        });
                } else {
                    // No hay usuario autenticado, redirigir al login
                    window.location.href = "login.html";
                }
            });
            
            // Agregar funcionalidad de cierre de sesión
            const userProfile = document.querySelector('.user-profile');
            if (userProfile) {
                userProfile.addEventListener('click', function() {
                    if (confirm('¿Desea cerrar sesión?')) {
                        firebase.auth().signOut()
                            .then(function() {
                                window.location.href = "login.html";
                            })
                            .catch(function(error) {
                                console.error("Error al cerrar sesión:", error);
                            });
                    }
                });
            }
        }
    });
</script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
<script type="module" src="scripts/dashboardAdmin.js"></script>
<script type="module" src="firebase/firebase.js"></script>
<script type="module" src="firebase/userManagement.js"></script>
<script type="module" src="firebase/1.js"></script>
<script type="module" src="firebase/2.js"></script>

</body>
</html>